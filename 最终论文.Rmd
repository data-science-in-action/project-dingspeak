---
title: '  欧洲疫情规模预测及境外输入导致的中国疫情二次爆发风险评估'
author: "组员：刘晓菡、孙融雪、王帆、程宏宇"
date: '2020-06-19'
---
```{r echo = FALSE, results='hide', warning = FALSE, message = FALSE}
library(ggplot2);library(jsonlite);library(rjson);library(RJSONIO)
library(RColorBrewer);library(lubridate)
library(plyr);library(dplyr);library(rgdal)
library(sf);library(geojsonio);library(sp);library(ggthemes)
```

```{r echo = FALSE, results='asis', warning = FALSE}
```


## 摘要
2020年年初，我国爆发严重的新型冠状病毒疫情，随后，该病毒相继在其他国家爆发，给世界经济发展、 人民健康和社会安全带来巨大考验。为研究欧洲疫情发展状况以及评估境外输入带来的中国疫情二次爆发风险， 本文采用Logistic增长模型来拟合疫情规模，并结合网格搜索法来优化模型参数。结果表明，①意大利由于对疫 情不够重视导致确诊人数不断攀升，在95%的置信度下，最终疫情规模的置信区间为[226930,231670]，可能为 中国的4倍左右；②境外输入确实是造成我国疫情绵延不绝的主因，但在当前严密的防疫措施下，反弹风险仍在 可控范围内，根据模型结果得到中国境外输入病例95%的置信区间为[1537,2025]，所有参数估计值均在0.01的 水平下显著，且模型的拟合优度均在97%以上。因此，未来我国应当坚持防疫工作常态化，在积极复工复学的同 时时刻保持警惕，严防疫情反弹。


## 1、引言
  
&emsp;&emsp;距离疫情发生已经过去了近四个月时间了，在这段时间里大家经历了一场前所未有的防疫战斗。从2019年12月开始，陆续有武汉市民被确诊为“不明肺炎病症”，2020年1月7日，初步判定该疾病元凶为新型冠状病毒，接着，疫情爆发，专家证实了该病毒具有人传人的性质，武汉发出交通封城通告，全国各地纷纷紧急启动一级响应，国家紧急筹建火神山雷神山医院，各地纷纷向武汉提供紧急援助。截至2020年4月，我国新冠疫情已经基本稳定，多地传来了零新增的好消息，但战斗还远远未结束。
  
&emsp;&emsp;根据政府发布的《抗击新冠肺炎疫情的中国行动》白皮书，中国抗击疫情的艰辛历程可分为五个阶段。第一阶段:迅速应对突发疫情期(2019.12.27-2020.1.19）。湖北省武汉市监测发现不明原因肺炎病例，中国第一时间报告疫情，迅速采取行动，开展病因学和流行学调查。第二阶段：初步遏制疫情蔓延势头期（1.20-2.20）。全国新增确诊病例快速增加，中国采取阻断病毒传播的关键一招，坚决果断关闭离汉离鄂通道，武汉保卫战、湖北保卫战全面打响。第三阶段：本土新增病例下降期（2.21-3.17）。中共中央作出统筹疫情防控和经济社会发展、有序复工复产重大决策。第四阶段：武汉抗疫决胜期（3.18-4-28）。以武汉市为主战场的全国本土疫情传播基本阻断，离汉离鄂通道管控措施解除，武汉市在院新冠肺炎患者清零。第五阶段：疫情防控常态化期（4.29-至今）。
境内疫情总体呈零星散发状态，局部地区出现散发病例引起的聚集性疫情。综上所述，我国疫情已趋于平稳，基本得到有效控制控制。
  
&emsp;&emsp;在境外输入的问题上，一方面从国家政策来看，在3月2日以前，我国疫情防控的政策是“三线作战”，即外防输入、内防扩散、严防境外疫情倒灌。从3月3日开始，把防范疫情输入作为当前防控工作的重中之重。3月4日下午，北京市北京市委常委会议及北京新冠疫情防控工作领导小组第38次会议召开，会议提出，当前疫情防控形势逐步向好，但与之形成鲜明反差的是境外疫情呈现加速扩散趋势，境外输入已成为摆在我们面前的突出威胁。从实际数据来看，根据中国卫生健康委员会公布的每日新增感染者和境外输入病例数可知，境外输入病例从三月中旬起持续呈现波动上涨的态势，到四月下旬才基本得到控制。同时，日增境外输入占日增总病例的比例保持在80%左右，可以推测境外输入成为我国当前疫情延绵不休的最大威胁。
  
&emsp;&emsp;在疫情全球大流行的特殊时期，不断新增的病例预示着我国疫情反弹的风险仍然存在。如果疫情大幅反弹，不仅将导致前期防控成果功亏一篑，人民生命健康受到威胁，而且会对复苏中的经济造成致命一击。可见，境外输入病例已成为当前疫情中最危险和不稳定的因素。故本文将使用逻辑斯蒂增长模型，以意大利为例研究境外疫情发展状况以及评估境外输入导致的中国疫情二次爆发风险。

  
## 2、文献综述
  
&emsp;&emsp;已有文献大多从疫情初期出发，研究中国或国外本次疫情的持续时间以及最终规模。金启祥利用统计学模型对中国新冠疫情进行预测建模和评估，认为2月中旬前后我国疫情将基本得到控制。Batista利用逻辑增长模型对世界上几个国家的COVID-19流行的最终规模进行预测，认为中国和韩国最终规模约为8万人，而其他国家由于疫情发展的不可控性最终规模不明确。这些文章让我们在疫情中期对中国和世界上疫情发展态势有大致预判，为我们选题提供思路。在方法上，徐荣辉扩展了逻辑方程的应用场景，阐述了该模型在生物学、医学、经管学等方面的实际应用，拓展了我们的研究思路。综上，基于疫情全球大流行和中国疫情区域平稳的特殊时期，本文开辟新的研究视角，以意大利为例探索境外疫情发展规模，并研究境外病例的输入对中国疫情反弹带来的威胁。
  

## 3、数据来源与模型介绍
  
### 3.1数据来源
&emsp;&emsp;本次研究数据来源于：  
  
①中国国家卫健委：http://www.nhc.gov.cn/xcs/xxgzbd/gzbd_index.shtml
  
②意大利卫生部：http://www.salute.gov.it/portale/nuovocoronavirus/archivioComunicatiNuovoCoronavirus.jsp
  
  
### 3.2模型介绍
  
#### 3.2.1 Logistic增长模型
  
&emsp;&emsp;逻辑斯蒂方程由比利时数学家兼生物学家皮埃尔·弗朗索瓦·韦吕勒(Pierre Francois Verhulst)在研究人口增长模型时提出，是对马尔萨斯人口模型(Malthus, 1798)的改进。
  
&emsp;&emsp;马尔萨斯人口模型假定人口增长率$r$保持不变，增长速度满足方程：
$$\frac {dP} {dt} = rP$$
其中$P$表示人口数，是时间$t$的函数。
  
&emsp;&emsp;求解该微分方程可以得到人口随时间变化的函数：
$$P（t） = P_0e^{rt}$$
  
&emsp;&emsp;不难发现，人口呈现指数增长，即J型曲线。然而现实中受到自然资源约束以及疾病等因素影响，人口增长率不可能一直保持不变。皮埃尔在马尔萨斯人口模型的基础上进行了改进，将人口增长率设为$r(1−PK)$,其中$K$可以理解为环境最大允许的最大人口数量。此时，当人口$P$越接近于$K$时，增长率越低，即人口增长率随人口数量的增加而线性减少。
$$\frac {dP} {dt} = r(1-\frac{P}{K})P$$

  
&emsp;&emsp;求解微分方程可以得到人口随时间变化的函数为：
$$P(t)= \frac {K} {1+(\frac {dK} {dP_0}-1)e^{-rt}} $$
其中$P_0$表示第0期人口。
  
&emsp;&emsp;该曲线描述的人口增长呈现S型，增长速率随时间先增后减，在$P=K/2$处增长最快。注意到，增长速率$\frac{dP}{dt}$表示人口当期变化的绝对数值，而增长率$\frac{dP}{dt}/p$表示人口变化量与当期人口的比值。相比于马尔萨斯人口模型，Logistic增长模型更加符合实际，该模型常常被应用于描述种群、传染病增长以及商品销售量预测等领域。
 
## 3.2.2 网格搜索（GridSearchCV）
  
&emsp;&emsp;为找到最优参数从而优化预测结果，我们使用网格调参法。
  
&emsp;&emsp;简单而言，网格搜索的对象为模型参数，即在指定的参数范围内，按步长依次调整参数，利用调整的参数训练学习器，从所有的参数中找到在验证集上精度最高的参数，这其实是一个训练和比较的过程，可以保证在指定的参数范围内找到精度最高的参数。这种穷举算法通常要求在所有候选的参数选择中，通过循环遍历，尝试每一种可能性，遍历所有可能参数的组合，在面对大数据集和多参数的情况下，非常耗时，所以网格搜索适用于三四个（或者更少）的参数（当参数的数量增长时，网格搜索的计算复杂度会呈现指数增长，这时候则使用随机搜索）。网格搜索算法本质上就是使用每组参数训练模型，并挑选验证集误差最小的参数组合。在本文的模型中，待定系数有：人口增长率$r$、初始人口$P_0$以及环境容量$K$，根据最小化MSE准则，对$K$以1为步长遍历可能区间，对增长率$r$以0.01为步长遍历（0，1）区间，以求得误差最小时的最优参数。


## 4、实证分析
  
### 4.1描述性统计分析

&emsp;&emsp;本章节我们从国内疫情和全球疫情两方面入手绘制统计图。对于国内疫情我们绘制了每日新增确诊人数与境外输入确诊病例数对比图、全国累计确诊人数地域分布图和境外输入累计确诊人数时序图；针对全球疫情绘制了世界各国累计确诊病例分布图、意大利每日新增病例和累计确诊病例时序图。

#### 4.1.1 每日新增确诊人数与境外输入确诊病例数对比

<center>
```{r echo=FALSE, results='asis',warning = FALSE}
data1 <- read.table("final presentation/comefromforeign.csv",header = TRUE,sep = ",")

time_day<-as.Date(data1$time,"%Y/%m/%d")
number = data1$all.day
b = data1$foreign.day
data2 <- cbind(as.Date(time_day),number,b)
data3 <- data.frame(data2)

ggplot()+
    geom_line(data=data3,aes(y=number,x = time_day,colour="darkblue"),
              size = 1 )+
    geom_line(data=data3,aes(y=b,x = time_day,colour="red"),size = 1)+
  scale_color_discrete(name = "lable", labels = c("total", "foreign"))+
  theme(panel.grid = element_blank(),
        panel.background = element_blank(),
        plot.title = element_text(hjust = 0.5)
        )+
  labs(x = "Date", y = "Confirmed cases")

```   
</center>

<center>图1 每日新增感染人数与境外输入病例人数对比图（单位：人）</center>

&emsp;&emsp;由图1可以看出，3月4日至3月16日，境外输入确诊病例占国内确诊人数小于50%，3月16日至四月15日，5月22日至6月10日的两条曲线重合度非常高，这表示国内新增病例主要是由境外输入人群引起，6月13日北京市确诊3名新冠肺炎病例，均前往过新发地市场，随后北京市确诊病例数开始有上升趋势，带动国内日新增病例数增加，两条曲线贴合度进一步拉开。综合来看，新冠疫情在中国爆发以来，国内迅速采取了相应对策，使得境内确诊病例迅速减少，3月16日之后境外输入病例大幅增加，且成为新增病例主要因素；在政府出台限制人员入境以及延长部分外国人在华停留期限等政策后，即4月23日后，我国境内和境外日新增病例数开始<50人，且呈波动下降趋势。

#### 4.1.2 全国累计确诊人数分布

```{r echo = FALSE, results='hide', warning = FALSE, message = FALSE}

x <- readOGR("final presentation/省级行政区.shp",stringsAsFactors=FALSE,encoding="UTF-8")

prov_map <- fortify(x)

p_id=read.csv("final presentation/全国累计确诊人数(6.17_24时).csv")

totalp=data.frame(id=p_id$id,pnum=p_id$number,
                  number=cut(p_id$number,breaks=c(0,9,99,499,999,9999,68135),
                             labels=c("<10","10-99","100-499","500-999","1000-9999",">=10000"),
                             order = TRUE,include.lowest = TRUE,right = F))

ttp<-merge.data.frame(prov_map,totalp,by.prov_map="id",by.totalp="id")
```
<center>
```{r echo = FALSE, results='asis', warning = FALSE}

ggplot()+
  geom_polygon(data=ttp,aes(x = long ,y = lat ,group = group, fill = number),
               colour="black",size=0.25)+
  #theme_bw()+  白色背景
  theme(panel.grid = element_blank(),       #去主次网络线#
        panel.background = element_blank(), 
        axis.text = element_blank(),         #去横纵坐标#
        axis.ticks = element_blank()        #去外边框#
        )+
  xlab("") + ylab("")+
  scale_fill_manual(values = brewer.pal(8,"Reds"))
```
</center>

<center>图2 全国累计确诊人数地域分布图</center>

&emsp;&emsp;截止2020年6月17日24时，我国新冠肺炎累计确诊人数为84903例，其中湖北省确诊人数达到68135例，占全部确诊病例的80.25%，从图中可以看到湖北省的颜色最深，其次是周边省份如上方的河南省、下方湖南省，以及临海的浙江省、广东省，这四省的确诊病例共计5192例，占全部病例的6.12%，颜色深度仅次于湖北省。西部地区确诊人数最少，其中西藏只有一例，在地图中的颜色最浅。

#### 4.1.3 境外输入累计确诊人数

<center>
```{r echo=FALSE, results='asis',warning = FALSE}
#library(ggplot2)
dataforei <- read.csv("final presentation/comefromforeign.csv", header = T)
daytime <- as.Date(dataforei$time,"%Y/%m/%d")
number <- dataforei$totalforeign
datafor2 <- cbind(as.Date(daytime),number)
datafor3 <- data.frame(datafor2)

ggplot(data = datafor3, aes(y = number, x = daytime))+
  geom_line(colour="darkblue", size = 1)+
  geom_bar(colour = "orange", stat = "identity",
           width = 0.2, position = position_dodge(0.2))+
 # labs(title="Cumulative Imported Cases" )+ 
  theme(panel.grid = element_blank(),
        panel.background = element_blank(),
        plot.title = element_text(hjust = 0.5)
        )+
  labs(x = "Date", y = "cumulative confirmed cases")
```
</center>

<center>图3 境外输入累计确诊人数时序图</center>

&emsp;&emsp;我们对2020年3月4日至6月14日的境外输入累计确诊人数进行描述，柱状图如图3所示，从中可以看到，3月中旬至4月上旬这20多天的时间，是境外输入病例增长最快的一段时期，曲线斜率最大，4月中旬至5月底，曲线逐渐平缓，进入6月份后特别是6月12-14日，曲线的斜率再次变大，从图1中也可以观察到每日新增境外输入确诊病例又有上升的趋势。

#### 4.1.4 世界各国累计确诊病例

<center>
```{r echo=FALSE, results='asis',warning = FALSE}

#library(ggplot2)
data31 <- read.table("final presentation/World.csv",header = TRUE,sep = ",")

ggplot(data31,aes(x=country,y=number,
                  color = continent)
       )+
  geom_bar(aes(fill = continent), width = 0.5,  stat = "identity")+
  geom_text(aes(label = number), size = 3, vjust = -0.7)+
 # labs(title="COVID-19 Cases in World" )+ 
  theme(panel.grid = element_blank(),
        panel.background = element_blank(),
        plot.title = element_text(hjust = 0.5),  #标题居中
        legend.title = element_blank(),
        )+
  labs(x = "Country", y = "cumulative confirmed cases")

```
</center>

<center>图4 COVD-19在世界各国的确诊病例分布柱状图</center>

&emsp;&emsp;新冠病毒COVID-19在中国的传播得到了很好的抑制，但是在全球的蔓延趋势依然严峻。我们根据截至2020年6月17日24时的数据绘制了全球新冠病毒累计确诊病例排名前10的国家及其分布柱状图，见图3。从中可以看出，美国目前的累计确诊病例数最高，达到2234854例，其次为巴西955377例，俄罗斯561091例。从颜色上可以看出排名前10的国家所属的洲：亚洲有一个国家印度，累计确诊368705人;欧洲有五个国家，分别是德国190179例，意大利237828例，西班牙291768例，应该199251例和俄罗斯，这五个国家总确诊人数超过100万；北美疫情严峻的国家除美国外还有墨西哥，累计确诊人数159793例；南美则有巴西和秘鲁。

#### 4.1.5 意大利确诊病例分析

```{r echo=FALSE, results='asis',warning = FALSE}
mydata <- read.table("final presentation/data_Italy2.csv",header = TRUE,sep = ",")

time_day <- as.Date(mydata$Time, "%Y/%m/%d")
number1 = mydata$todaynew
number2 = mydata$total
data2 <- cbind(as.Date(time_day), number1, number2)
data3 <- data.frame(data2)

ggplot(data3, aes(x = time_day))+
  geom_line(aes(y = number1, colour = "per day"))+
  geom_line(aes(y = number2/20, colour = "Cumulant"))+
  scale_y_continuous(sec.axis = 
                       sec_axis(~.*20, name = "Cumulative confirmed cases"))+
  scale_colour_manual(values = c("blue","red"))+
  labs(x = "Date", y = "New cases per day")+
  theme(#panel.grid = element_blank(),
    panel.background = element_blank())
```
</center>

<center>图5 意大利新冠病毒每日新增和累计确诊趋势图</center>

&emsp;&emsp;图5描述的是2020年2月20日至6月10日期间的数据，通过意大利每日新增病例数（红色）可以看出，3月中旬至4月22日是意大利新增病例数增幅巨大的时期，波动也较为剧烈，其中最大值发生在3月22日，该日新增病例达到6557人。进入5月后，单日新增病例开始低于2000人，且呈波动下降趋势，通过累计确诊病例曲线（蓝色）也可以观察到这一点，在3月中旬-4月底曲线的斜率较大，随后逐渐平缓。
  
### 4.2意大利疫情建模结果分析<br />

#### 4.2.1Logistic模型估计意大利疫情<br />

&emsp;&emsp;基于Logistic增长模型并结合网格搜索法，得到意大利相关参数的预测值如表1所示。<br />

<center>表1 意大利疫情相关参数的预测结果</center>

|Parameter | Estimate |SE |tstat|pValue|
|:-----:|:----:|:----:|:----:|:----:|
|K  |229300|1195|191.94|<2e-16|
|r |0.09214|0.002001|46.05|<2e-16|

RMSE:6239.261; R-Square:0.996; MAE:5451.0738731<br />

&emsp;&emsp;根据表1中的结果可知，利用Logistic模型建模可得意大利确诊病例最大值K为229300，增长速率r约为0.09，且参数均在0.01的水平下显著。模型拟合的R-Squared达0.996，RMSE为6239.261，MAE约为5451.074，模型拟合情况较好。经过进一步计算可知意大利确诊病例的最大值95%的置信区间为[226930,231670]，可以看出意大利最终确诊病例数处于较高水平。<br />

#### 4.2.2不同参数确定方法下Logistic模型预测意大利疫情结果对比<br />

&emsp;&emsp;本文对于意大利疫情数据的建模探索分为两个阶段。首先，在意大利疫情发展中前期，利用截止到4月19日的数据进行建模，同时模型参数初始值的选取参考了文献中给出的方法；其次，在意大利疫情发展的中后期，利用截止到6月10日的数据进行建模，模型参数的确定利用网格搜索法。本文利用两组数据结合两种估计参数的方法分别进行预测，并对不同结果进行比较分析。<br />

##### 1.利用文献中的参数估计方法<br />

<center>表2 利用参考文献中的初始值参数估计方法对意大利疫情的预测结果</center>

|   Date |  Actual |Predicted |Error|Error%|
|:-----:|:----:|:----:|:----:|:----:|
|2020/4/20  |178972|169968|9004|5.031|
|2020/4/21 |181228|170888|10340|5.706|
|2020/4/22  |187327|171700|15627|8.342|
|2020/4/23 |189973|172414|17559|9.243|


&emsp;&emsp;表2中的结果是利用截止到4月19日的数据进行建模，并借鉴参考文献中给出的计算相关参数初始值的方法进行预测。可以看出，根据模型预测出四天之后的结果，绝对误差最小值在9000左右，相对误差的最小值在5%左右，之后到4月23号的预测绝对误差和相对误差都在增大。<br />

##### 2.利用利用网格搜索法优化参数<br />

<center>表3 利用网格搜索的参数估计方法对意大利疫情的预测结果</center>

|   Date |  Actual |Predicted |Error|Error%|
|:-----:|:----:|:----:|:----:|:----:|
|2020/6/11  |235763|229563|6200|2.630|
|2020/6/12 |236142|229609|6533|2.767|
|2020/6/13  |236305|229652|6653|2.815|
|2020/6/14 |236651|229691|6960|2.941|

&emsp;&emsp;将模型进行改进，利用网格搜索来为模型选择更合适的参数，再进行建模。建模利用的是截至6月10日的数据，依旧是对未来四天的确诊病例数进行预测，可以看出预测的绝对误差和相对误差都比较小(2%-3%)，相比于之前利用的模型，预测精度有了较大的提升。<br />

#### 4.2.3对比分析<br />

&emsp;&emsp;意大利急于在疫情未能完全控制的情况下开始复工复产，虽然早在4月1日时，意大利卫生研究院的专家就表示，意大利新冠肺炎疫情正在进入平台期，但后来意大利逐步放松管控，导致确诊病例复增，情况复杂。同时，利用截止至4月19日的数据进行建模，当时意大利疫情尚未出现明显拐点，且意大利疫情发展处于波动上升阶段，比较类似于指数增长，还没有出现所谓的比较明显的拐点以及平台期发展趋势，因此，模型拟合情况较好但预测效果不理想。在更新数据和改进模型的参数估计方法的基础上再次对其建立Logistic增长模型，结果有了较好的预测性能。<br />
&emsp;&emsp;初期意大利疫情发展较快的原因主要有三个。第一，新冠肺炎病毒本身的传染性较强，意大利政府虽然很早就对从中国回国的民众进行了登记，但14天严格的隔离并没有得到执行，因此在这种情况下只要有一只漏网之鱼，病毒就可能在意大利国内大规模传播。第二，意大利之前对疫情不够重视，在意大利疫情爆发的初期，还是举行了很多大规模的集会和比赛。虽然意大利已经采取了一系列紧急措施，停止了球赛、狂欢节等活动，但可以预料的是，由于之前的疏忽，意大利的新冠患者很可能会继续增长。第三，初期意大利进行了大规模检测，而欧洲别国没有。<br />
&emsp;&emsp;而对于意大利疫情发展的拐点出现较晚的原因，主要是政府比较早地开始放松了管制，在2月23日时，意大利就成为了欧洲疫情最严重的国家。3月14日，世卫组织宣布欧洲是全球新冠疫情重灾区。但是在4月14日意大利政府开始允许部分行业解禁，可以恢复营业，由此导致确诊人数又开始急剧增长，将疫情进入拐点的趋势拉回。但即使这样，4月19日时意大利总理孔特在社交媒体上表示，5月4日起计划逐步放松管控，因此导致了意大利疫情的拐点迟迟没有出现。<br />


### 4.3Logistic模型估计中国疫情与意大利疫情的对比<br />

&emsp;&emsp;根据参考文献中的参数初值预测方法，利用Logistic增长模型对中国疫情的相关参数预测结果如表4所示。<br />

<center>表4 中国疫情相关参数的预测结果</center>

|Parameter | Estimate |SE |tstat|pValue|
|:-----:|:----:|:----:|:----:|:----:|
|K  |80772|489.04|165.16|2.0205e-72|
|r |0.22568|0.0062941|35.855|2.4094e-38|

RMSE:1.9e+03; R-Square:0.977; Adjusted R-Square:0.977<br />

&emsp;&emsp;综合表1和表4中的结果，对比中国和意大利疫情发展的相关数据，可以看出利用意大利疫情数据进行建模，疫情人数的最大值在230000左右，而中国疫情人数的最大值在80000左右。但是在增长率方面，意大利的疫情人数增长率低于中国。出现这种现象的原因可总结为以下两点：第一，中国在检测较为全面的基础上，大批感染者被及时发现，并且中国采取了较为积极的防疫政策，使疫情在较短的时间之内被控制住，因此在前期中国确诊病例的增长率较高；第二，意大利在疫情初期可控时封锁部分城镇，但居民仍举行游行示威活动反对封城，没有与政府之间进行有效配合，并且医疗体系受到了较大挑战使疫情迟迟不能得到有效控制，因此虽然相比较中国增长率较低但感染总人数处于较高水平。<br />


### 4.4境外输入病例建模结果分析<br />

#### 4.4.1境外输入病例建模结果<br />

&emsp;&emsp;本文对境外输入病例进行建模利用的是截止到4月16日的数据，且利用了R中适用于Logistic模型的getInitial函数来对模型的初始输入参数值进行估计。得到的相关结果如表5所示。<br />

<center>表5 中国疫情相关参数的预测结果</center>

|Parameter | Estimate |SE |tstat|pValue|
|:-----:|:----:|:----:|:----:|:----:|
|K  |1781|122.2|14.580|<2e-16|
|r |0.1191|0.009525|12.502|9.57e-16|

RMSE:74.17; MAE:54.52; R-Square:0.978<br />

&emsp;&emsp;从表5中可以看出，利用Logistic增长模型对境外输入病例拟合情况较为理想，RMSE为74.17，R-Square达0.978，且各个参数的估计值在0.01的水平下均显著。通过进一步计算可知，模型预测境外输入病例的最大值的95%置信区间为[1537,2025]，这一数据符合在无特殊时境外输入病例的实际情况。

<center>
```{r echo = FALSE, results='hide', warning = FALSE, message = FALSE}
m<-(0:44)
n<-c(18,20,36,60,63,67,69,79,85,88,95, 111, 123,143,155,189,228,269,314,353,427,474,541,595,649,963,723,771,806,841,870,888,913,951,983,1042,1103,1141,1183,1280,1378,1464,1500,1534,1549)
df<-as.data.frame(cbind(m,n))
SS <- getInitial(n ~ SSlogis(m, alpha, xmid, scale), data = df)
K_start <- SS["alpha"]
R_start <- 1/SS["scale"]
N0_start <- SS["alpha"]/(exp(SS["xmid"]/SS["scale"])+1)
log_formula <- formula(n ~ K*N0*exp(R*m)/(K + N0*(exp(R*m) - 1)))
formu<-nls(log_formula, start = list(K = K_start, R = R_start, N0 = N0_start))
ggplot(df,aes(m,predict(formu)))+geom_line()+
     geom_point(aes(y=n), color='red')+
     theme_bw()+
     theme(panel.grid.minor = element_blank(),panel.grid.major = element_blank())+xlab("days")+ylab("confirmed")
```

```{r echo = FALSE, results='asis', warning = FALSE}
```
</center>

<center>图6 境外输入病例拟合结果与真实值对比图</center>
 
&emsp;&emsp;从图6中也可以看出，模型拟合情况较为理想，虽然实际中有个别异常值的存在，但模型整体拟合结果与真实值较为接近。<br />

#### 4.4.2境外输入病例预测结果<br />

&emsp;&emsp;利用截至4月16日的境外输入病例数据进行建模，并对未来6天的境外输入病例数进行预测，得到的结果如表6所示:<br />

<center>表6 利用Logistic模型对境外输入病例的预测结果</center>

|   Date  |  Actual |Predicted |Error%|
|:-----:|:----:|:----:|:----:|
|2020/4/17  |1566|1518|3.162|
|2020/4/18 |1575|1544|2.008|
|2020/4/19  |1583|1567|1.011|
|2020/4/20 |1587|1588|0.063|
|2020/4/21  |1610|1608|0.124|
|2020/4/22 |1616|1625|0.557|


&emsp;&emsp;从表6中可以看出，模型进行预测的预测值与真实值之间的相对误差较小，模型预测精度较高，用该模型对未来境外输入病例进行预测较为合理。<br />

## 5、结论与建议<br />

### 5.1 结论<br />

&emsp;&emsp;本文基于Logistic增长模型，利用不同时期意大利COVID-19确诊病例数和国内输入性病例数据进行建模，且对意大利疫情规模进行预测时讨论了不同的参数估计方法，建立了预测精度较高的预测模型。最终预测意大利COVID-19确诊病例数95%的置信区间为[226930,231670]，模型的RMSE为6239，MAE为5451；中国境外输入病例95%的置信区间为[1537,2025]，模型的RMSE为74.17，MAE为54.52。所有参数估计值均在0.01的水平下显著，且模型的拟合优度均在97%以上。<br />

（一）疫情发展形势千变万化，意大利在疫情初期没有足够的重视，在确诊人数不断上升时期仍举行大规模集会、游行，导致疫情发展失控；中期实施封城措施，在原有的基础上加大检测力度，但医疗系统仍旧吃紧，如伦巴第大区的日检测能力仅为一万左右，甚至不足以覆盖每日全部疑似病例；目前在疫情未能完全控制的情况下政府开始复工复产，导致确诊病例复增，情况复杂。且意大利作为数据上最早爆发的西方国家，一直是西方世界防疫的风向标。意大利逐步地解封，不仅使本国疫情发展的拐点不能如期而至，而且可能产生的联动效应或许将席卷整个西方世界。因此，利用Logistic增长模型可以对疫情的发展进行预估，但是要进行更加准确的预测需要再进行数据的更新；并且在r和K的选取上也可进行更加深入的讨论和研究，提高模型拟合的准确性。<br />

&emsp;&emsp;由此也可以看出，在意大利及许多西方国家，抗疫无法速战速决，导致确诊人数不断增加，以及拖垮了经济，经济危机和债务雪崩导致的损失甚至远大于（现阶段）感染带来的损失。罗马和马德里、柏林、巴黎一样，一直在“两害取其轻”。经济永远是西方当前执政模式下的核心利益。<br />

（二）根据建模结果，在短期内不发生较大波动的条件下，国内疫情二次爆发的可能性较低。输入性疫情在目前可预计的情况下，其控制比武汉的疫情容易得多。因此尽管现在面临着输入性的风险，但是这个风险是可控的。<br />

&emsp;&emsp;随着疫情不断的发展，很多欧美国家已经采取了和中国非常相近的策略，包括封城，限制人群聚集，鼓励在人多的地方戴口罩，这些都是一个非常正面、积极的信号。自3月28日0时起，中国已暂停持有中国签证的外国人入境，但仍有较多中国籍病例从疫区返回，境外输入病例数波动较大，但总体来看利用模型进行拟合结果较为理想；在不发生特殊情况的条件下，境外输入病例确诊最值为1800左右。但同时目前没有标准答案，疫情具有极大的不确定性。因此加强检测、严防输入仍是重中之重。<br />

### 5.2建议<br />
  
&emsp;&emsp;根据结论，对我国未来疫情防控提出相应建议：
  
（一）强化对境外输入群体的筛查和防控力度。加强我国对流动人口的监控与人员信息的管理，以便于建立完善的网络追溯系统来对境外输入者尤其境外输入感染者及密切接触者进行筛查和感染回溯。同时还应加强对密切接触者和医学观察人员的管理和有效的核酸检测，具体可以参考浙江省对无症状感染者采取14天隔离+14天观察的严格防控手段，时刻保持警惕，防止疫情反弹。
  
（二）对重点区域、部门政府实行长效措施和精确管理。
对于人员密集区域，如学校、商场等，坚持实行人员发热监测制度以及区域精确化分类管理，防控常态化对于防止疫情扩散有重要的作用。对内要重视本土感染者，对外要严防海外输入，对境外流入人员严格实行隔离政策和核酸检测措施，在疫情没有完全结束之前严格执行海关检查、14天的隔离观察以及医疗机构就诊这三道防线，严防二次爆发风险。
  
（三）注重个人自我防护与，提高居民健康卫生意识。
加强对公众的宣传教育，坚决将政策贯彻实施到社区等基层，发挥我国群防群控的优势，关注公共卫生安全。倡导民众在重要时期仍要坚持外出戴口罩，尽量避免去人员密集场所，保持适当的社交距离，居家常通风，出现发热等不适症状及时到就近发热门诊就诊。输入感染者及密切接触者进行筛查和感染回溯。同时还应加强对密切接触者和医学观察人员的管理和有效的核酸检测，具体可以参考浙江省对无症状感染者采取14天隔离+14天观察的严格防控手段，时刻保持警惕，防止疫情反弹。<br />

## 6、不足之处<br />
&emsp;&emsp;本文的研究仍有值得深入探讨的地方，主要有以下三点：第一，利用逻辑斯蒂增长模型只能对疫情的发展的最终情况进行预估，但不能描述疫情发展的全过程；第二，在确诊病例数处于迅速增长阶段时Logistic增长模型预测效果可能不理想，即在爆发时期确诊病例更近似于指数增长；第三，参数的优化方面值得更深入的研究，更多的讨论有一篇杨益民等人的文章，是关于逻辑斯蒂增长模型参数估计方法的再探讨，里面提出了一种估计K和r的线性化方法，叫做“最佳”观测点数定向搜索法，可供之后参考学习。<br />




  
## 参考文献
[1]徐荣辉. 逻辑斯蒂方程及其应用[J]. 山西财经大学学报, 2010(S2):311-312.
  
[2]金启轩.中国新冠肺炎疫情预测建模与理性评估[J].统计与决策,2020,36(05):11-14.
  
[3]Estimation of the final size of the second phase of the coronavirus epidemic by the logistic model：https://www.medrxiv.org/content/10.1101/2020.03.11.20024901v2 <br />

[4]杨益民,付必谦.关于Logistic增长模型参数估计方法的再探讨[J].统计与决策,2015(13):28-32.


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

