---
title: '  欧洲疫情规模预测及境外输入导致的中国疫情二次爆发风险评估'
author: "组员：刘晓菡、孙融雪、王帆、程宏宇"
date: "2020/6/19"
output: slidy_presentation
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

## 内容简介  


- 引言
- 参考文献
- 数据及研究方法
- 描述性统计分析
- 模型实证及结果
- 结论与建议

## 1.引言
  
  
1.1国内疫情现状  

2020年初迅猛爆发的新型冠状病毒疫情让我们经历了一场前所未有的防疫战斗。
根据政府发布的《抗击新冠肺炎疫情的中国行动》白皮书，中国抗击疫情的艰辛历程可分为五个阶段。
  
  
    第一阶段:  (2019.12.27-2020.1.19）
  
  湖北省武汉市监测发现不明原因肺炎病例，中国第一时间报告疫情，迅速采取行动，开展病因学和流行学调查。
  
   
      
    第二阶段：（1.20-2.20）
  
  全国新增确诊病例快速增加，中国采取阻断病毒传播的关键一招，坚决果断关闭离汉离鄂通道，武汉保卫战、湖北保卫战全面打响。
    
    第三阶段：（2.21-3.17）
  
  中共中央作出统筹疫情防控和经济社会发展、有序复工复产重大决策。
  
## 1.1国内疫情现状
  
    
    第四阶段：（3.18-4-28）
  
    
   以武汉市为主战场的全国本土疫情传播基本阻断，离汉离鄂通道管控措施解除，武汉市在院新冠肺炎患者清零。
  
    第五阶段：（4.29-至今）。
境内疫情总体呈零星散发状态，局部地区出现散发病例引起的聚集性疫情。
  
   由此可见，我国疫情已趋于平稳，基本得到有效控制控制。

## 1.2境外输入形势

  
  在3月2日以前，我国疫情防控的政策是“三线作战”，即外防输入、内防扩散、严防境外疫情倒灌。
    
  从3月3日开始，把防范疫情输入作为当前防控工作的重中之重。

  3月4日召开的中共中央政治局常务委员会会议研究当前新冠肺炎疫情防控和稳定经济社会运行重点工作，在要求持续用力，加强湖北省和武汉市疫情防控工作的同时，要求突出抓好北京等重点地区疫情防控。

  3月4日下午，北京市北京市委常委会议及北京新冠疫情防控工作领导小组第38次会议召开，会议提出，当前疫情防控形势逐步向好，但与之形成鲜明反差的是境外疫情呈现加速扩散趋势，境外输入已成为摆在我们面前的突出威胁。
  
  

## 1.2境外输入现状 
```{r echo=FALSE, results='asis',warning = FALSE}
data1 <- read.table("comefromforeign.csv",header = TRUE,sep = ",")

time_day<-as.Date(data1$time,"%Y/%m/%d")
number = data1$all.day
b = data1$foreign.day
data2 <- cbind(as.Date(time_day),number,b)
data3 <- data.frame(data2)
library(ggplot2)
ggplot()+
    geom_line(data=data3,aes(y=number,x = time_day,colour="darkblue"),size = 1 )+
    geom_line(data=data3,aes(y=b,x = time_day,colour="red"),size = 1)+
  scale_color_discrete(name = "lable", labels = c("total", "foreign"))

```   
  
图1：每日新增感染人数与境外输入病例人数对比图（单位：人）



## 1.引言
  
  
无论从实际人数还是国家政策来看，
在疫情全球大流行的特殊时期，不断新增的病例预示着我国疫情反弹的风险仍然存在。  
  
如果疫情大幅反弹，不仅将导致前期防控成果功亏一篑，人民生命健康受到威胁，而且会对复苏中的经济造成致命一击。可见，境外输入病例已成为当前疫情中最危险和不稳定的因素。


## 2.文献介绍
  
  
1.
徐荣辉. 逻辑斯蒂方程及其应用[J]. 山西财经大学学报, 2010(S2):311-312.
2.
金启轩.中国新冠肺炎疫情预测建模与理性评估[J].统计与决策,2020,36(05):11-14.

3.
Estimation of the final size of the second phase of the coronavirus epidemic by the logistic model
  
    来源：https://www.medrxiv.org/content/10.1101/2020.03.11.20024901v2

## 3.数据及研究方法
3.1数据来源
  
  本次研究数据来源于：  

①中国国家卫健委：  
  
http://www.nhc.gov.cn/xcs/xxgzbd/gzbd_index.shtml
  
②意大利卫生部：
  
http://www.salute.gov.it/portale/nuovocoronavirus/archivioComunicatiNuovoCoronavirus.jsp
  
## 3.2研究方法

3.2.1 Logistic增长模型
  
逻辑斯蒂方程由比利时数学家兼生物学家皮埃尔·弗朗索瓦·韦吕勒(Pierre Francois Verhulst)在研究人口增长模型时提出，是对马尔萨斯人口模型(Malthus, 1798)的改进。

马尔萨斯人口模型假定人口增长率$r$保持不变，增长速度满足方程：
$$\frac {dP} {dt} = rP$$
其中$P$表示人口数，是时间$t$的函数。
求解该微分方程可以得到人口随时间变化的函数：
$$P（t） = P_0e^{rt}$$
不难发现，人口呈现指数增长，即J型曲线。然而现实中受到自然资源约束以及疾病等因素影响，人口增长率不可能一直保持不变。

## 3.2.1 Logistic增长模型 
  
  
皮埃尔在马尔萨斯人口模型的基础上进行了改进，将人口增长率设为$r(1−PK)$,其中$K$可以理解为环境最大允许的最大人口数量。此时，当人口$P$越接近于$K$ 时，增长率越低，即人口增长率随人口数量的增加而线性减少。
$$\frac {dP} {dt} = r(1-\frac{P}{K})P$$

求解微分方程可以得到人口随时间变化的函数为：
$$P(t)= \frac {K} {1+(\frac {dK} {dP_0}-1)e^{-rt}} $$
其中$P_0$表示第0期人口。


该曲线描述的人口增长呈现S型，增长速率随时间先增后减，在$P=K/2$处增长最快。注意到，增长速率$\frac{dP}{dt}$表示人口当期变化的绝对数值，而增长率$\frac{dP}{dt}/p$表示人口变化量与当期人口的比值。相比于马尔萨斯人口模型，Logistic增长模型更加符合实际，该模型常常被应用于描述种群、传染病增长以及商品销售量预测等领域。
 
## 3.2.2 网格搜索（GridSearchCV）

为找到最优参数从而优化预测结果，我们使用网格调参法。
  
定义：简单而言，网格搜索的对象为模型参数，即在指定的参数范围内，按步长依次调整参数，利用调整的参数训练学习器，从所有的参数中找到在验证集上精度最高的参数，这其实是一个训练和比较的过程，可以保证在指定的参数范围内找到精度最高的参数。
  
缺点：这也是网格搜索的缺陷所在，他要求在所有候选的参数选择中，通过循环遍历，尝试每一种可能性，遍历所有可能参数的组合，在面对大数据集和多参数的情况下，非常耗时，所以网格搜索适用于三四个（或者更少）的参数（当参数的数量增长时，网格搜索的计算复杂度会呈现指数增长，这时候则使用随机搜索）。
  
本质：网格搜索算法本质上就是使用每组参数训练模型，并挑选验证集误差最小的参数组合。
  
案例：以有两个参数的模型为例，参数a有3中可能，参数b有4种可能，把所有可能性列出来，可以表示成一个3×4的表格，其中每个组合就是一个网格，循环过程就像是在每个网格里遍历，搜索，所以叫grid search。

　　
　　

# **Logistic模型估计意大利疫情结果的对比**

数据截至4月19日，借鉴论文中的参数进行建模预测结果：<br />
（*Estimation of the final size of the second phase of the coronavirus COVID 19 epidemic by the logistic model*）

K=177500(2233)<br />

|   Date |  Actual |Predicted |Error|Error%|
|:-----:|:----:|:----:|:----:|:----:|
|2020/4/20  |178972|169968|9004|5.031|
|2020/4/21 |181228|170888|10340|5.706|
|2020/4/22  |187327|171700|15627|8.342|
|2020/4/23 |189973|172414|17559|9.243|

1.意大利在疫情未能完全控制的情况下开始复工复产，导致确诊病例复增，情况复杂；<br />
2.当时意大利疫情尚未出现明显拐点，疫情发展处于波动上升阶段，模型拟合情况较好但预测效果不理想。<br />

# **利用网格搜索法优化参数**
|   Date |  Actual |Predicted |Error|Error%|
|:-----:|:----:|:----:|:----:|:----:|
|2020/6/11  |235763|229563|6200|2.630|
|2020/6/12 |236142|229609|6533|2.767|
|2020/6/13  |236305|229652|6653|2.815|
|2020/6/14 |236651|229691|6960|2.941|

# **结论**
1.根据模型的预测结果，意大利确诊病例总数达230100例，模型预测的相对误差小于3%；<br />
2.意大利在4月中旬时，疫情未能完全控制的情况下开始复工复产，导致确诊病例复增，确诊病例继续增长，直至五月中旬确诊病例增长才趋于平缓，疫情发展波动曲折，长时间不能得到有效的控制；

# **不足之处**
1.Logistic模型只能对疫情的发展的最终情况进行预估，但不能描述疫情发展的全过程；<br />
2.在确诊病例数处于迅速增长阶段时预测效果可能不理想；<br />
3.参数的优化方面值得更深入的研究（参考：杨益民,付必谦.关于Logistic增长模型参数估计方法的再探讨[J].统计与决策,2015(13):28-32.）





```{r cars, echo = TRUE}


```



```{r pressure}

```

